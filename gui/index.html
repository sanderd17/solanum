<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Solanum</title>
  <meta name="description" content="Solanum">
  <meta name="author" content="Sander Deryckere">

  <link rel="stylesheet" href="/css/styles.css">

</head>

<body>
  <svg id="body" style="position:absolute;left:0;top:0" viewbox="0 0 1000 500"></svg>
  <div id="errorOverlay">
  <script type="module" >
    import MainWindow from "./index.js"
    import ts from "./lib/TagSet.js"
    import messager from "./lib/Messager.js"
    let handlers = ts.getMessageHandlers()
    for (let msgName in handlers) {
        messager.registerMessageHandler(msgName, handlers[msgName])
    }

    let mainWindow = new MainWindow()
    mainWindow.init(null, 'body', {}, {x:0, y:0, width: window.innerWidth, height: window.innerHeight})
    let svg = document.querySelector("#body")
    svg.innerHTML = mainWindow.getSvg(svg)

    mainWindow.addDataBindings()
    mainWindow.addTagBindings()
    mainWindow.addEventHandlers()

    messager.connectToServer(location.host)
    // expose singletons for debugging purposes (via browser console)
    window['ts'] = ts
    window['messager'] = messager
    window['mainWindow'] = mainWindow
  </script>
</body>
</html>
